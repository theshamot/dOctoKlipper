V// source: plugin/tracking/js/usage.js\u000a$(function () {\u000a    function UsageViewModel(parameters) {\u000a        var self = this;\u000a\u000a        self.settingsViewModel = parameters[0];\u000a\u000a        self.setup = ko.observable(false);\u000a\u000a        self.decision = ko.observable();\u000a        self.active = ko.observable();\u000a        self.required = false;\u000a\u000a        self.enableUsage = function () {\u000a            self.settingsViewModel.settings.plugins.tracking.enabled(true);\u000a            self.decision(true);\u000a            self._sendData();\u000a        };\u000a\u000a        self.disableUsage = function () {\u000a            self.settingsViewModel.settings.plugins.tracking.enabled(false);\u000a            self.decision(false);\u000a            self._sendData();\u000a        };\u000a\u000a        self.onBeforeWizardTabChange = function (next, current) {\u000a            if (!self.required) return true;\u000a\u000a            if (\u000a                !current ||\u000a                !_.startsWith(current, "wizard_plugin_tracking") ||\u000a                self.setup()\u000a            ) {\u000a                return true;\u000a            }\u000a\u000a            self._showDecisionNeededDialog();\u000a            return false;\u000a        };\u000a\u000a        self.onBeforeWizardFinish = function () {\u000a            if (!self.required) return true;\u000a\u000a            if (self.setup()) {\u000a                return true;\u000a            }\u000a\u000a            self._showDecisionNeededDialog();\u000a            return false;\u000a        };\u000a\u000a        self.onWizardDetails = function (response) {\u000a            self.required = response && response.tracking && response.tracking.required;\u000a        };\u000a\u000a        self._showDecisionNeededDialog = function () {\u000a            showMessageDialog({\u000a                title: gettext("Please set up anonymous usage tracking"),\u000a                message: gettext(\u000a                    "You haven't yet decided on whether to enable or disable anonymous usage tracking. You need to either enable or disable it before continuing."\u000a                )\u000a            });\u000a        };\u000a\u000a        self._sendData = function () {\u000a            var data = {\u000a                plugins: {\u000a                    tracking: {\u000a                        enabled: self.settingsViewModel.settings.plugins.tracking.enabled()\u000a                    }\u000a                }\u000a            };\u000a\u000a            self.active(true);\u000a            self.settingsViewModel\u000a                .saveData(data)\u000a                .done(function () {\u000a                    self.setup(true);\u000a                    self.active(false);\u000a                })\u000a                .fail(function () {\u000a                    self.decision(false);\u000a                    self.setup(true);\u000a                    self.active(false);\u000a\u000a                    var message = gettext(\u000a                        "Please open a <a href='%(bugreport)s' target='_blank' rel='noopener noreferrer'>" +\u000a                            "bug report</a> on this. Make sure to include all requested information, including your " +\u000a                            "<a href='%(jsconsole)s' target='_blank' rel='noopener noreferrer'>JS console</a> and " +\u000a                            "<code>octoprint.log</code>."\u000a                    );\u000a                    new PNotify({\u000a                        title: gettext("Something went wrong"),\u000a                        text: _.sprintf(message, {\u000a                            bugreport:\u000a                                "https://github.com/OctoPrint/OctoPrint/blob/master/CONTRIBUTING.md#how-to-file-a-bug-report",\u000a                            jsconsole: "https://webmasters.stackexchange.com/a/77337"\u000a                        }),\u000a                        type: "error",\u000a                        hide: false\u000a                    });\u000a                });\u000a        };\u000a    }\u000a\u000a    OCTOPRINT_VIEWMODELS.push([\u000a        UsageViewModel,\u000a        ["settingsViewModel"],\u000a        "#wizard_plugin_tracking"\u000a    ]);\u000a});\u000a\u000a;\u000a
p0
.