V// source: plugin/consolidate_temp_control/js/consolidate_temp_control.js\u000a$(function() {\u000a	function ConsolidateTempControlViewModel(parameters) {\u000a		var self = this;\u000a\u000a		self.controlViewModel = parameters[0];\u000a		self.temperatureViewModel = parameters[1];\u000a		self.settings = parameters[2];\u000a		self.touchui = parameters[3];\u000a		self.dragonorder = parameters[4];\u000a		self.webcamtab = parameters[5];\u000a		self.tab_order_selector = ko.pureComputed(function(){\u000a								var tabs = ko.utils.arrayMap(self.settings.settings.plugins.consolidate_temp_control.tab_order(), function(tab) {\u000a										return tab.selector();\u000a									});\u000a								return tabs;\u000a							});\u000a\u000a		self.onBeforeBinding = function(){\u000a			// don't load when touchui is active and hide tab.\u000a			if (self.touchui && self.touchui.isActive()) {\u000a				$('#tab_plugin_consolidate_temp_control_link, #tab_plugin_consolidate_temp_control').remove();\u000a				return;\u000a			}\u000a\u000a			// move original temp and control tab content and remove tab links.\u000a			ko.utils.arrayForEach(self.tab_order_selector(), function(tab) {\u000a				$(tab).appendTo('#tab_plugin_consolidate_temp_control > div.row-fluid').removeClass('tab-pane');\u000a			});\u000a			$('#temp_link, #control_link').remove();\u000a\u000a			if(self.settings.settings.plugins.consolidate_temp_control.layout() == 'horizontal' && (screen.width >= parseInt(self.settings.settings.plugins.consolidate_temp_control.resolution_threshold(), 10) && self.settings.settings.plugins.consolidate_temp_control.resolution_threshold() >= 0)){\u000a				// page container adjustments\u000a				$('div.page-container').css({'min-width':'1900px'});\u000a\u000a				// navbar adjustments\u000a				if(self.settings.settings.plugins.consolidate_temp_control.resize_navbar()){\u000a					$('#navbar > div.navbar-inner > div.container').css({'width':'100%'});\u000a					$('#navbar > div.navbar-inner > div.row-fluid > div.nav-collapse').css({'padding-right':'20px'});\u000a				}\u000a\u000a				// main content adjustments\u000a				$('div.container.octoprint-container').addClass('row-fluid');\u000a				$('div.container.octoprint-container.row-fluid > div.row').css({'margin-left':'20px','padding-right':'20px'});\u000a\u000a				// sidebar adjustments\u000a				if (!self.dragonorder) {\u000a					if($('div#settings_plugin_themeify').length == 0){\u000a						$('div.container.octoprint-container > div.row > div.accordion.span4').removeClass('span4').addClass('span2');\u000a					}\u000a					$('#files div.row-fluid.upload-buttons > span.btn.btn-primary.fileinput-button.span6:nth-child(2) > span').text('Upload SD');\u000a				}\u000a\u000a				// tabs adjustments\u000a				$('#tab_plugin_consolidate_temp_control > div.row-fluid > div').addClass('span6');\u000a				if($('div#settings_plugin_themeify').length == 0 && !self.dragonorder){\u000a					$('div.container.octoprint-container > div.row > div.tabbable.span8').removeClass('span8').addClass('span10');\u000a					$('div#tabs_content div.tab-pane:not("#tab_plugin_consolidate_temp_control")').wrapInner('<div class="span6"></div>');\u000a					$('div#tabs_content div.tab-pane:not("#tab_plugin_consolidate_temp_control") div.span6').wrap('<div class="row-fluid"></div>');\u000a				}\u000a\u000a				// footer adjustments\u000a				$('div.container.octoprint-container > div.footer').css({'padding-left':'20px','padding-right':'20px'});\u000a			} else {\u000a				$('#temp, #control').removeClass('span6');\u000a			}\u000a		}\u000a\u000a		self.onAfterBinding = function(){\u000a			self.active_settings = ko.toJSON(self.settings.settings.plugins.consolidate_temp_control);\u000a		}\u000a\u000a		self.onEventSettingsUpdated = function(){\u000a			if(ko.toJSON(self.settings.settings.plugins.consolidate_temp_control) !== self.active_settings) {\u000a				$('#reloadui_overlay_wrapper > div > div > p:nth-child(2)').html('Consolidated Temp Control layout changes detected, you must reload now for these new changes to take effect. This will not interrupt any print jobs you might have ongoing.');\u000a				$('#reloadui_overlay').modal();\u000a			}\u000a		}\u000a\u000a		// fix control tab\u000a		self.onTabChange = function(current, previous) {\u000a			if ((current === "#tab_plugin_consolidate_temp_control") || (current === "#temp") || (current === "#control") || (current === "#tab_plugin_webcamtab")) {\u000a				var selected = OctoPrint.coreui.selectedTab;\u000a				if (self.webcamtab) {\u000a					OctoPrint.coreui.selectedTab = "#tab_plugin_webcamtab";\u000a					self.controlViewModel.onTabChange("#tab_plugin_webcamtab", previous);\u000a				} else {\u000a					OctoPrint.coreui.selectedTab = "#control";\u000a					self.controlViewModel.onTabChange("#control", previous);\u000a				}\u000a				OctoPrint.coreui.selectedTab = selected;\u000a			} else if (previous === "#tab_plugin_consolidate_temp_control") {\u000a				self.controlViewModel.onTabChange(current, "#control");\u000a			}\u000a		};\u000a\u000a		self.onAllBound = function(allViewModels) {\u000a			var selected = OctoPrint.coreui.selectedTab;\u000a			if (self.webcamtab) {\u000a				OctoPrint.coreui.selectedTab = "#tab_plugin_webcamtab";\u000a			} else {\u000a				OctoPrint.coreui.selectedTab = "#control";\u000a			}\u000a			self.controlViewModel.onAllBound(allViewModels);\u000a			OctoPrint.coreui.selectedTab = selected;\u000a			if (selected == "#tab_plugin_consolidate_temp_control" || selected == "#temp") {\u000a				self.temperatureViewModel._initializePlot();\u000a			}\u000a		};\u000a\u000a		self.controlViewModel.onBrowserTabVisibilityChange = function(status) {\u000a			if (status) {\u000a				var selected = OctoPrint.coreui.selectedTab;\u000a				if (self.webcamtab) {\u000a					OctoPrint.coreui.selectedTab = "#tab_plugin_webcamtab";\u000a				} else {\u000a					OctoPrint.coreui.selectedTab = "#control";\u000a				}\u000a				self.controlViewModel._enableWebcam();\u000a				OctoPrint.coreui.selectedTab = selected;\u000a			} else {\u000a				self.controlViewModel._disableWebcam();\u000a			}\u000a		};\u000a\u000a		// fix temperature tab\u000a		self.onAfterTabChange = function(current, previous) {\u000a			if ((current === "#tab_plugin_consolidate_temp_control") || (current === "#temp") || (current === "#control")) {\u000a				if (!self.temperatureViewModel.plot) {\u000a					self.temperatureViewModel._initializePlot();\u000a				} else {\u000a					self.temperatureViewModel.updatePlot();\u000a				}\u000a				self.temperatureViewModel.onAfterTabChange("#temp", previous);\u000a			}\u000a		}\u000a	}\u000a\u000a	OCTOPRINT_VIEWMODELS.push({\u000a		construct: ConsolidateTempControlViewModel,\u000a		dependencies: ["controlViewModel", "temperatureViewModel", "settingsViewModel", "touchUIViewModel", "dragon_orderViewModel", "WebcamTabViewModel"],\u000a		optional: ["touchUIViewModel", "dragon_orderViewModel", "WebcamTabViewModel"],\u000a		elements: ["#consolidate_temp_control_settings_form"]\u000a	});\u000a});\u000a\u000a;\u000a
p0
.