V// source: plugin/bedlevelvisualizer/js/bedlevelvisualizer.js\u000a/*\u000a * View model for OctoPrint\u000a *\u000a * Amendments by: LMS0815\u000a * License: AGPLv3\u000a *\u000a * http://beautifytools.com/javascript-validator.php\u000a *\u000a*/\u000a$(function () {\u000a	function bedlevelvisualizerViewModel(parameters) {\u000a		var self = this;\u000a\u000a		self.settingsViewModel = parameters[0];\u000a		self.controlViewModel = parameters[1];\u000a		self.loginStateViewModel = parameters[2];\u000a\u000a		self.processing = ko.observable(false);\u000a		self.mesh_data = ko.observableArray([]);\u000a		self.mesh_data_x = ko.observableArray([]);\u000a		self.mesh_data_y = ko.observableArray([]);\u000a		self.mesh_data_z_height = ko.observable();\u000a		self.save_mesh = ko.observable();\u000a		self.save_snapshots = ko.observable(false);\u000a		self.selected_command = ko.observable();\u000a		self.settings_active = ko.observable(false);\u000a		self.webcam_streamUrl = ko.computed(function(){\u000a			if(self.processing() && self.settingsViewModel.settings.plugins.bedlevelvisualizer.show_webcam() && (self.settingsViewModel.webcam_streamUrl() !== "")) {\u000a				return self.settingsViewModel.webcam_streamUrl();\u000a			} else {\u000a				return "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+P+/HgAFhAJ/wlseKgAAAABJRU5ErkJggg==";\u000a			}\u000a		});\u000a		self.mesh_status = ko.computed(function(){\u000a			if(self.processing()){\u000a				return 'Collecting mesh data.';\u000a			}\u000a			if (self.save_mesh() && self.mesh_data().length > 0) {\u000a				return 'Using saved mesh data from ' + self.settingsViewModel.settings.plugins.bedlevelvisualizer.mesh_timestamp() + '.';\u000a			} else {\u000a				return 'Update mesh.';\u000a			}\u000a		});\u000a\u000a		self.screw_hub = ko.observable();\u000a		self.mesh_unit = ko.observable();\u000a		self.reverse = ko.observable();\u000a		self.showdegree = ko.observable();\u000a		self.imperial = ko.observable();\u000a		self.descending_x = ko.observable();\u000a		self.descending_y = ko.observable();\u000a		self.mesh_zero = ko.observable(0);\u000a		self.mesh_adjustment = ko.computed(\u000a			function() {\u000a				var degrees = ko.utils.arrayMap(\u000a					self.mesh_data(),\u000a					function(line) {\u000a					return ko.utils.arrayMap(\u000a						line,\u000a						function(item) {\u000a						return ((parseFloat(item) - parseFloat(self.mesh_zero())) * parseFloat(self.mesh_unit()) * 360 / (self.imperial()?25.4/parseFloat(self.screw_hub()):parseFloat(self.screw_hub())));\u000a						}\u000a				);\u000a					}\u000a				);\u000a				return degrees;\u000a				},\u000a			self);\u000a		self.turn = ko.observable(0);\u000a		self.graph_z_limits = ko.observable();\u000a\u000a		self.onBeforeBinding = function() {\u000a			self.mesh_data(self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh());\u000a			self.mesh_data_x(self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_x());\u000a			self.mesh_data_y(self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_y());\u000a			self.mesh_data_z_height(self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_z_height());\u000a			self.save_mesh(self.settingsViewModel.settings.plugins.bedlevelvisualizer.save_mesh());\u000a			self.save_snapshots(self.settingsViewModel.settings.plugins.bedlevelvisualizer.save_snapshots());\u000a			self.screw_hub(self.settingsViewModel.settings.plugins.bedlevelvisualizer.screw_hub());\u000a			self.mesh_unit(self.settingsViewModel.settings.plugins.bedlevelvisualizer.mesh_unit());\u000a			self.reverse(self.settingsViewModel.settings.plugins.bedlevelvisualizer.reverse());\u000a			self.showdegree(self.settingsViewModel.settings.plugins.bedlevelvisualizer.showdegree());\u000a			self.imperial(self.settingsViewModel.settings.plugins.bedlevelvisualizer.imperial());\u000a			self.descending_x(self.settingsViewModel.settings.plugins.bedlevelvisualizer.descending_x());\u000a			self.descending_y(self.settingsViewModel.settings.plugins.bedlevelvisualizer.descending_y());\u000a			self.graph_z_limits(self.settingsViewModel.settings.plugins.bedlevelvisualizer.graph_z_limits());\u000a		};\u000a\u000a		self.onAfterBinding = function() {\u000a			$('div#settings_plugin_bedlevelvisualizer i[data-toggle="tooltip"],div#tab_plugin_bedlevelvisualizer i[data-toggle="tooltip"],div#wizard_plugin_bedlevelvisualizer i[data-toggle="tooltip"],div#settings_plugin_bedlevelvisualizer pre[data-toggle="tooltip"]').tooltip();\u000a			$('#bedlevelvisualizer_tabs a').on('show.bs.tab', function(event){\u000a				if($(event.target).text() === 'Current Mesh Data'){\u000a					self.settings_active(true);\u000a					return\u000a				}\u000a				if ($(event.relatedTarget).text() === 'Current Mesh Data'){\u000a					self.settings_active(false);\u000a				}\u000a			});\u000a		};\u000a\u000a		self.onSettingsBeforeSave = function() {\u000a			self.settingsViewModel.settings.plugins.bedlevelvisualizer.screw_hub(self.screw_hub());\u000a			self.settingsViewModel.settings.plugins.bedlevelvisualizer.mesh_unit(self.mesh_unit());\u000a			self.settingsViewModel.settings.plugins.bedlevelvisualizer.reverse(self.reverse());\u000a			self.settingsViewModel.settings.plugins.bedlevelvisualizer.showdegree(self.showdegree());\u000a			self.settingsViewModel.settings.plugins.bedlevelvisualizer.imperial(self.imperial());\u000a			self.settingsViewModel.settings.plugins.bedlevelvisualizer.descending_x(self.descending_x());\u000a			self.settingsViewModel.settings.plugins.bedlevelvisualizer.descending_y(self.descending_y());\u000a			if(self.settingsViewModel.settings.plugins.bedlevelvisualizer.colorscale().length === 0) self.settingsViewModel.settings.plugins.bedlevelvisualizer.colorscale('[[0, "rebeccapurple"],[0.4, "rebeccapurple"],[0.45, "blue"],[0.5, "green"],[0.55, "yellow"],[0.6, "red"],[1, "red"]]');\u000a			if(self.settingsViewModel.settings.plugins.bedlevelvisualizer.rotation().length === 0) self.settingsViewModel.settings.plugins.bedlevelvisualizer.rotation(0);\u000a			if(self.settingsViewModel.settings.plugins.bedlevelvisualizer.timeout().length === 0) self.settingsViewModel.settings.plugins.bedlevelvisualizer.timeout(1800);\u000a		};\u000a\u000a		self.onSettingsHidden = function() {\u000a			self.settings_active(false);\u000a		};\u000a\u000a		self.onEventSettingsUpdated = function () {\u000a			self.mesh_data(self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh());\u000a			self.save_mesh(self.settingsViewModel.settings.plugins.bedlevelvisualizer.save_mesh());\u000a			self.save_snapshots(self.settingsViewModel.settings.plugins.bedlevelvisualizer.save_snapshots());\u000a			self.graph_z_limits(self.settingsViewModel.settings.plugins.bedlevelvisualizer.graph_z_limits());\u000a		};\u000a\u000a		self.onDataUpdaterPluginMessage = function (plugin, mesh_data) {\u000a			if (plugin !== "bedlevelvisualizer") {\u000a				return;\u000a			}\u000a			var i;\u000a			if (mesh_data.mesh) {\u000a				if (mesh_data.mesh.length > 0) {\u000a					var x_data = [];\u000a					var y_data = [];\u000a\u000a					for( i = 0;i <= (mesh_data.mesh[0].length - 1);i++) {\u000a						if ((mesh_data.bed.type == "circular") || self.settingsViewModel.settings.plugins.bedlevelvisualizer.use_center_origin()) {\u000a							x_data.push(Math.round(mesh_data.bed.x_min - (mesh_data.bed.x_max/2)+i/(mesh_data.mesh[0].length - 1)*(mesh_data.bed.x_max - mesh_data.bed.x_min)));\u000a						} else {\u000a							x_data.push(Math.round(mesh_data.bed.x_min+i/(mesh_data.mesh[0].length - 1)*(mesh_data.bed.x_max - mesh_data.bed.x_min)));\u000a						}\u000a					}\u000a\u000a					for( i = 0;i <= (mesh_data.mesh.length - 1);i++) {\u000a						if ((mesh_data.bed.type == "circular") || self.settingsViewModel.settings.plugins.bedlevelvisualizer.use_center_origin()) {\u000a							y_data.push(Math.round(mesh_data.bed.y_min - (mesh_data.bed.y_max/2)+i/(mesh_data.mesh.length - 1)*(mesh_data.bed.y_max - mesh_data.bed.y_min)));\u000a						} else {\u000a							y_data.push(Math.round(mesh_data.bed.y_min+i/(mesh_data.mesh.length - 1)*(mesh_data.bed.y_max - mesh_data.bed.y_min)));\u000a						}\u000a					}\u000a					self.drawMesh(mesh_data.mesh,true,x_data,y_data,mesh_data.bed.z_max);\u000a					self.mesh_data(mesh_data.mesh);\u000a					self.mesh_data_x(x_data);\u000a					self.mesh_data_y(y_data);\u000a					self.mesh_data_z_height(mesh_data.bed.z_max);\u000a				}\u000a				return;\u000a			}\u000a			if (mesh_data.error) {\u000a				clearTimeout(self.timeout);\u000a				self.processing(false);\u000a				new PNotify({\u000a					title: 'Bed Visualizer Error',\u000a					text: '<div class="row-fluid"><p>Looks like your settings are not correct or there was an error.</p><p>Please see the <a href="https://github.com/jneilliii/OctoPrint-BedLevelVisualizer/#tips" target="_blank">Readme</a> for configuration tips.</p></div><p><pre style="padding-top: 5px;">'+mesh_data.error+'</pre></p>',\u000a					hide: true\u000a				});\u000a				return;\u000a			}\u000a			if (mesh_data.processing) {\u000a				self.processing(true);\u000a			}\u000a			return;\u000a		};\u000a\u000a		self.drawMesh = function (mesh_data_z,store_data,mesh_data_x,mesh_data_y,mesh_data_z_height) {\u000a			// console.log(mesh_data_z+'\u005cn'+store_data+'\u005cn'+mesh_data_x+'\u005cn'+mesh_data_y+'\u005cn'+mesh_data_z_height);\u000a			console.log(mesh_data_z);\u000a			clearTimeout(self.timeout);\u000a			self.processing(false);\u000a			if ( self.save_mesh()) {\u000a				if (store_data) {\u000a					self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh(mesh_data_z);\u000a					self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_x(mesh_data_x);\u000a					self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_y(mesh_data_y);\u000a					self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_z_height(mesh_data_z_height);\u000a					self.settingsViewModel.settings.plugins.bedlevelvisualizer.mesh_timestamp(new Date().toLocaleString());\u000a					self.settingsViewModel.saveData();\u000a				}\u000a			}\u000a\u000a			try {\u000a				var graphcolorscale = (self.settingsViewModel.settings.plugins.bedlevelvisualizer.colorscale().charAt(0) === "[") ? JSON.parse(self.settingsViewModel.settings.plugins.bedlevelvisualizer.colorscale()) : self.settingsViewModel.settings.plugins.bedlevelvisualizer.colorscale();\u000a				if (graphcolorscale.length === 0) graphcolorscale = [[0, "rebeccapurple"],[0.4, "rebeccapurple"],[0.45, "blue"],[0.5, "green"],[0.55, "yellow"],[0.6, "red"],[1, "red"]];\u000a				var data = [{\u000a						z: mesh_data_z,\u000a						x: mesh_data_x,\u000a						y: mesh_data_y,\u000a						type: 'surface',\u000a						colorbar: {\u000a							tickfont: {\u000a								color: $('#tabs_content').css('color')\u000a							}\u000a						},\u000a						autocolorscale: false,\u000a						colorscale: graphcolorscale\u000a					}\u000a				];\u000a\u000a				if(self.graph_z_limits().split(",")[0] !== 'auto'){\u000a					data[0]['cmin'] = self.graph_z_limits().split(",")[0];\u000a					data[0]['cmax'] = self.graph_z_limits().split(",")[1];\u000a				}\u000a\u000a				var background_color = $('#tabs_content').css('background-color');\u000a				var foreground_color = $('#tabs_content').css('color');\u000a\u000a				var layout = {\u000a					//title: 'Bed Leveling Mesh',\u000a					autosize: true,\u000a					plot_bgcolor: background_color,\u000a					paper_bgcolor: background_color,\u000a					margin: {\u000a						l: 0,\u000a						r: 0,\u000a						b: 0,\u000a						t: 0\u000a					},\u000a					scene: {\u000a						camera: {\u000a							eye: {\u000a								x: -1.25,\u000a								y: -1.25,\u000a								z: 0.25\u000a							}\u000a						},\u000a						xaxis: {\u000a							color: foreground_color,\u000a							zerolinecolor: '#00FF00',\u000a							zerolinewidth: 4\u000a						},\u000a						yaxis: {\u000a							color: foreground_color,\u000a							zerolinecolor: '#FF0000',\u000a							zerolinewidth: 4\u000a						},\u000a						zaxis: {\u000a							color: foreground_color,\u000a							range: (self.graph_z_limits().split(",")[0] !== 'auto') ? self.graph_z_limits().split(',') : [-2,2],\u000a							zerolinecolor: '#0000FF',\u000a							zerolinewidth: 4\u000a						}\u000a					}\u000a				};\u000a\u000a				var config_options = {\u000a					displaylogo: false,\u000a					showEditInChartStudio: true,\u000a					responsive: true,\u000a					plotlyServerURL: "https://chart-studio.plotly.com",\u000a					modeBarButtonsToRemove: ['resetCameraDefault3d'],\u000a					modeBarButtonsToAdd: [{\u000a						name: 'Move Nozzle',\u000a						icon: Plotly.Icons.autoscale,\u000a						toggle: true,\u000a						click: function(gd, ev) {\u000a								var button = ev.currentTarget;\u000a								var button_enabled = button._previousVal || false;\u000a								if (!button_enabled) {\u000a									gd.on('plotly_click', function(data) {\u000a											var gcode_command = 'G0 X' + data.points[0].x + ' Y' + data.points[0].y + ' F4000';\u000a											OctoPrint.control.sendGcode([gcode_command]);\u000a										});\u000a									button._previousVal = true;\u000a								} else {\u000a									gd.removeAllListeners('plotly_click');\u000a									button._previousVal = null;\u000a								}\u000a							}\u000a						}]};\u000a				// Prusa Bed Level Correction\u000a				let back_half = mesh_data_z.slice(0, mesh_data_z.length/2).join().split(',');\u000a				let front_half = mesh_data_z.slice(mesh_data_z.length/2).join().split(',');\u000a				let left_half = (back_half.slice(0,back_half.length/2) + front_half.slice(0,front_half.length/2)).split(',');\u000a				let right_half = (back_half.slice(back_half.length/2) + front_half.slice(front_half.length/2)).split(',');\u000a\u000a				let back_half_total = 0;\u000a				let front_half_total = 0;\u000a				let left_half_total = 0;\u000a				let right_half_total = 0;\u000a\u000a				for(let i=0;i<back_half.length;i++){\u000a					back_half_total += parseFloat(back_half[i]);\u000a				}\u000a\u000a				for(let i=0;i<front_half.length;i++){\u000a					front_half_total += parseFloat(front_half[i]);\u000a				}\u000a\u000a				for(let i=0;i<left_half.length;i++){\u000a					left_half_total += parseFloat(left_half[i]);\u000a				}\u000a\u000a				for(let i=0;i<right_half.length;i++){\u000a					right_half_total += parseFloat(right_half[i]);\u000a				}\u000a\u000a				let back_half_um = Math.round((back_half_total/back_half.length)*1000);\u000a				let front_half_um = Math.round((front_half_total/front_half.length)*1000);\u000a				let left_half_um = Math.round((left_half_total/left_half.length)*1000);\u000a				let right_half_um = Math.round((right_half_total/right_half.length)*1000);\u000a\u000a				console.log('Back [um]:' + back_half_um);\u000a				console.log('Front [um]:' + front_half_um);\u000a				console.log('Left [um]:' + left_half_um);\u000a				console.log('Right [um]:' + right_half_um);\u000a\u000a				// graph surface\u000a				Plotly.react('bedlevelvisualizergraph', data, layout, config_options).then(self.postPlotHandler);\u000a			} catch(err) {\u000a				new PNotify({\u000a						title: 'Bed Visualizer Error',\u000a						text: '<div class="row-fluid">Errors while attempting render of mesh data.</div><div class="row-fluid">Error:</div><div class="row-fluid"><pre style="padding-top: 5px;">'+err+'</pre></div><div class="row-fluid">Received Data:</div><div class="row-fluid"><pre style="padding-top: 5px;">'+data+'</pre></div>',\u000a						type: 'error',\u000a						hide: false\u000a						});\u000a			}\u000a		};\u000a\u000a		self.postPlotHandler = function () {\u000a				if(self.save_snapshots()){\u000a					Plotly.downloadImage('bedlevelvisualizergraph',{filename:moment().format('YYYY-MM-DD_HH-mm-ss')});\u000a				}\u000a		};\u000a\u000a		self.onAfterTabChange = function (current, previous) {\u000a			if (current === "#tab_plugin_bedlevelvisualizer" && self.loginStateViewModel.isUser() && !self.processing()) {\u000a				if (!self.save_mesh()) {\u000a					if (self.controlViewModel.isOperational() && !self.controlViewModel.isPrinting()) {\u000a						self.updateMesh();\u000a					}\u000a				} else if (self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh().length > 0) {\u000a					self.drawMesh(self.mesh_data(),false,self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_x(),self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_y(),self.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_z_height());\u000a				}\u000a			}\u000a		};\u000a\u000a		self.updateMesh = function () {\u000a			self.processing(true);\u000a			self.timeout = setTimeout(function() {self.cancelMeshUpdate();new PNotify({title: 'Bed Visualizer Error',text: '<div class="row-fluid">Timeout occured before processing completed. Processing may still be running or there may be a configuration error. Consider increasing the Processing Timeout value in settings and restart OctoPrint.</div>',type: 'error',hide: false});}, (parseInt(self.settingsViewModel.settings.plugins.bedlevelvisualizer.timeout())*1000));\u000a			var gcode_cmds = self.settingsViewModel.settings.plugins.bedlevelvisualizer.command().split("\u005cn");\u000a			if (gcode_cmds.indexOf("@BEDLEVELVISUALIZER") == -1) {\u000a				gcode_cmds = ["@BEDLEVELVISUALIZER"].concat(gcode_cmds);\u000a			}\u000a			// clean extraneous code\u000a			gcode_cmds = gcode_cmds.filter(function(array_val) {\u000a					return Boolean(array_val) === true;\u000a				});\u000a\u000a			console.log(gcode_cmds);\u000a\u000a			OctoPrint.control.sendGcode(gcode_cmds);\u000a		};\u000a\u000a		self.cancelMeshUpdate = function() {\u000a			$.ajax({\u000a				url: API_BASEURL + "plugin/bedlevelvisualizer",\u000a				type: "GET",\u000a				dataType: "json",\u000a				data: {stopProcessing:true},\u000a				contentType: "application/json; charset=UTF-8"\u000a			}).done(function(data){\u000a				if(data.stopped){\u000a					clearTimeout(self.timeout);\u000a					self.processing(false);\u000a				}\u000a				});\u000a		};\u000a\u000a		// Custom command list\u000a\u000a		self.showEditor = function(data) {\u000a			self.selected_command(data);\u000a			$('#BedLevelVisulizerCommandEditor').modal('show');\u000a		};\u000a\u000a		self.copyCommand = function(data) {\u000a			self.settingsViewModel.settings.plugins.bedlevelvisualizer.commands.push({\u000a																					icon: ko.observable(data.icon()),\u000a																					label: ko.observable(data.label()),\u000a																					tooltip: ko.observable(data.tooltip()),\u000a																					command: ko.observable(data.command()),\u000a																					confirmation: ko.observable(data.confirmation()),\u000a																					message: ko.observable(data.message()),\u000a																					enabled_while_printing: ko.observable(data.enabled_while_printing()),\u000a																					enabled_while_graphing: ko.observable(data.enabled_while_graphing()),\u000a																					input: ko.observableArray(data.input())});\u000a		};\u000a\u000a		self.moveCommandUp = function(data) {\u000a			var currentIndex = self.settingsViewModel.settings.plugins.bedlevelvisualizer.commands.indexOf(data);\u000a			if (currentIndex > 0) {\u000a				var queueArray = self.settingsViewModel.settings.plugins.bedlevelvisualizer.commands();\u000a				self.settingsViewModel.settings.plugins.bedlevelvisualizer.commands.splice(currentIndex-1, 2, queueArray[currentIndex], queueArray[currentIndex - 1]);\u000a			}\u000a		};\u000a\u000a		self.moveCommandDown = function(data) {\u000a			var currentIndex = self.settingsViewModel.settings.plugins.bedlevelvisualizer.commands.indexOf(data);\u000a			if (currentIndex < self.settingsViewModel.settings.plugins.bedlevelvisualizer.commands().length - 1) {\u000a				var queueArray = self.settingsViewModel.settings.plugins.bedlevelvisualizer.commands();\u000a				self.settingsViewModel.settings.plugins.bedlevelvisualizer.commands.splice(currentIndex, 2, queueArray[currentIndex + 1], queueArray[currentIndex]);\u000a			}\u000a		};\u000a\u000a		self.addCommand = function() {\u000a			self.settingsViewModel.settings.plugins.bedlevelvisualizer.commands.push({icon: ko.observable('fas fa-gear'), label: ko.observable(''), tooltip: ko.observable(''), command: ko.observable(''), confirmation: ko.observable(false), message: ko.observable(''), input: ko.observableArray([]), enabled_while_printing: ko.observable(false), enabled_while_graphing: ko.observable(false)});\u000a		};\u000a\u000a		self.removeCommand = function(data) {\u000a			self.settingsViewModel.settings.plugins.bedlevelvisualizer.commands.remove(data);\u000a		};\u000a\u000a		self.addParameter = function(data) {\u000a			data.input.push({label: ko.observable(''), parameter: ko.observable(''), value: ko.observable('')});\u000a		};\u000a\u000a		self.insertParameter = function(data) {\u000a			var text = self.selected_command().command();\u000a			text += '%(' + data.parameter() + ')s';\u000a			self.selected_command().command(text);\u000a			console.log(data);\u000a		};\u000a\u000a		self.removeParameter = function(data) {\u000a			var text = self.selected_command().command();\u000a			var search = '%\u005c\u005c(' + data.parameter() + '\u005c\u005c)s';\u000a			var re = new RegExp(search,"gm");\u000a			var new_text = text.replace(re, '');\u000a			self.selected_command().command(new_text);\u000a			self.selected_command().input.remove(data);\u000a		};\u000a\u000a		self.runCustomCommand = function(data) {\u000a			var gcode_cmds = data.command().split("\u005cn");\u000a			var parameters = {};\u000a\u000a			// clean extraneous code\u000a			gcode_cmds = gcode_cmds.filter(function(array_val) {\u000a					var x = Boolean(array_val);\u000a					return x === true;\u000a				});\u000a			if (data.input().length > 0) {\u000a				_.each(data.input(), function (input) {\u000a					if (!input.hasOwnProperty("parameter") || !input.hasOwnProperty("value")) {\u000a						return;\u000a					}\u000a					parameters[input.parameter()] = input.value();\u000a				});\u000a			}\u000a			if (data.confirmation()) {\u000a				showConfirmationDialog({\u000a					message: data.message(),\u000a					onproceed: function () {\u000a						OctoPrint.control.sendGcodeWithParameters(gcode_cmds, parameters);\u000a					}\u000a				});\u000a			} else {\u000a				OctoPrint.control.sendGcodeWithParameters(gcode_cmds, parameters);\u000a			}\u000a			event.currentTarget.blur();\u000a		};\u000a	}\u000a\u000a	OCTOPRINT_VIEWMODELS.push({\u000a		construct: bedlevelvisualizerViewModel,\u000a		dependencies: ["settingsViewModel", "controlViewModel", "loginStateViewModel"],\u000a		elements: ["#settings_plugin_bedlevelvisualizer", "#tab_plugin_bedlevelvisualizer", "#wizard_plugin_bedlevelvisualizer"]\u000a	});\u000a});\u000a\u000a;\u000a
p0
.